<div class="container">
  <div class="info-box">
    <div class="queue">
      <h2>Work queue</h2>
      <div class="button-row">
        <button
          *ngFor="let section of queue"
          (click)="setContent(section.key)"
          [class.active]="currentContent === section.key"
        >
          {{ section.label }}
        </button>
      </div>
      <div class="table-queue">
        <table>
          <thead>
            <tr>
              <th>Originator</th>
              <th>Client / Line</th>
              <th>Type</th>
              <th>Status</th>
              <th>Created</th>
              <th></th>
            </tr>
          </thead>
        </table>

        <cdk-virtual-scroll-viewport itemSize="50" class="viewport">
          <table>
            <tbody>
              <tr *cdkVirtualFor="let item of queueData">
                <td>{{ item.name }}</td>
                <td>{{ item.type }}</td>
                <td>{{ item.priority }}</td>
                <td>{{ item.account }}</td>
                <td>{{ item.due }}</td>
                <td class="menu-cell">
                  <div class="menu-wrapper" (click)="toggleQueueMenu(item.id)">
                    <div class="dots-vertical">⋮</div>
                    <div class="menu-options" *ngIf="openedQueueMenuId === item.id">
                      <button (click)="editItem(item)">Edit</button>
                      <button (click)="deleteItem(item)">Delete</button>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </cdk-virtual-scroll-viewport>
      </div>
    </div>

    <div class="goals">
      <h2>Portfolio goals</h2>
    </div>

    <div class="options">
      <div class="actions">
        <h2>Quick actions</h2>
        <div class="button-col">
          <button
            *ngFor="let section of actions"
            (click)="setContent(section.key)"
            [class.active]="currentContent === section.key"
          >
            {{ section.label }}
          </button>
        </div>
      </div>
      <div class="intelligence">
        <h2>Market intelligence</h2>
        <div class="intelligence-items">
          <div class="intelligence-item red">
            <div class="circle"></div>
            <span>Rate hardening in Cyber market - +15% YoY</span>
          </div>
          <div class="intelligence-item yellow">
            <div class="circle"></div>
            <span>New capacity entering Marine market</span>
          </div>
          <div class="intelligence-item blue">
            <div class="circle"></div>
            <span>Environmental regulatory changes in CA</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="accounts">
    <div class="accounts-nav">
      <h2>My accounts</h2>
      <input type="text" placeholder="Search" [(ngModel)]="searchTerm" (input)="filterPolicies()" />
      <div class="button-row">
        <button
          *ngFor="let section of accounts"
          (click)="setAccounts(section.key)"
          [class.active]="currentContent === section.key"
        >
          {{ section.label }}
        </button>
      </div>
    </div>
    <div class="table-accounts">
      <cdk-virtual-scroll-viewport itemSize="50" class="viewport">
        <table>
          <thead>
            <tr>
              <th>Account Name/Type</th>
              <th>Line</th>
              <th>Broker</th>
              <th>Renewal Date</th>
              <th>Premium</th>
              <th>Rated Premium</th>
              <th>Loss Ratio</th>
              <th>Appetite</th>
              <th>Status</th>
              <th>Triage</th>
              <th>Winability</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="filteredPoliciesData.length === 0">
              <td colspan="12" class="no-results">No results found</td>
            </tr>
            <tr *cdkVirtualFor="let policy of filteredPoliciesData">
              <td>{{ policy.name }} / {{ policy.lob }}</td>
              <td>{{ policy.line }}</td>
              <td>{{ policy.broker }}</td>
              <td>{{ policy.expiration }}</td>
              <td>{{ policy.premium }}</td>
              <td>{{ policy.ratedPremium }}</td>
              <td>{{ policy.lossRatio }}</td>
              <td>{{ policy.appetite }}</td>
              <td>{{ policy.status }}</td>
              <td>{{ policy.triage }}</td>
              <td>{{ policy.winability }}</td>
              <td class="menu-cell">
                <div class="menu-wrapper" (click)="toggleMenu(policy.id)">
                  <div class="dots-vertical">⋮</div>
                  <div class="menu-options" *ngIf="openedMenuId === policy.id">
                    <button (click)="editPolicy(policy)">Edit</button>
                    <button (click)="deletePolicy(policy)">Delete</button>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </cdk-virtual-scroll-viewport>
    </div>
  </div>
</div>
<app-edit-modal
  [data]="selectedItem"
  [visible]="isModalVisible"
  (close)="onModalClose()"
  (save)="onModalSave($event)"
></app-edit-modal>

